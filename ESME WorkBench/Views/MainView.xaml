<r:RibbonWindow x:Class="OneNavyModel.Views.MainView" xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
                xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
                xmlns:r="clr-namespace:Microsoft.Windows.Controls.Ribbon;assembly=RibbonControlsLibrary"
                xmlns:mef="http:\\www.codeplex.com\MEFedMVVM" xmlns:cinch="clr-namespace:Cinch;assembly=Cinch.WPF"
                xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
                xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
                xmlns:i="http://schemas.microsoft.com/expression/2010/interactivity"
                xmlns:ia="http://schemas.microsoft.com/expression/2010/interactions" xmlns:WPF="clr-namespace:HRC.WPF;assembly=HRC"
                xmlns:EnvironmentBuilder="clr-namespace:ESME.Views.EnvironmentBuilder;assembly=ESME.Views"
                xmlns:NAVO="clr-namespace:ESME.Environment.NAVO;assembly=ESME" xmlns:Utility="clr-namespace:HRC.Utility;assembly=HRC"
                xmlns:Main="clr-namespace:OneNavyModel.ViewModels.Main" xmlns:LocalControls="clr-namespace:OneNavyModel.Controls"
                xmlns:p="clr-namespace:OneNavyModel.Properties" mef:ViewModelLocator.ViewModel="MainViewModel"
                SnapsToDevicePixels="True" Title="{Binding MainWindowTitle}" Icon="..\Wave.ico"
                Top="{Binding Source={x:Static p:Settings.Default}, Path=WindowTop, Mode=TwoWay}"
                Left="{Binding Source={x:Static p:Settings.Default}, Path=WindowLeft, Mode=TwoWay}"
                Height="{Binding Source={x:Static p:Settings.Default}, Path=WindowHeight, Mode=TwoWay}"
                Width="{Binding Source={x:Static p:Settings.Default}, Path=WindowWidth, Mode=TwoWay}" d:DesignWidth="1400"
                d:DesignHeight="800" mc:Ignorable="d" d:DataContext="{d:DesignInstance Type=Main:MainViewModel}">
  <r:RibbonWindow.Resources>
    <WPF:GridLengthConverter x:Key="GridLengthConverter" />
    <Utility:NotNullConverter x:Key="NotNull" />
    <Utility:BooleanNegatingConverter x:Key="NegatingConverter" />
  </r:RibbonWindow.Resources>
  <r:RibbonWindow.InputBindings>
    <KeyBinding Command="{Binding CancelCurrentCommand}" Key="Escape" />
    <KeyBinding Command="{Binding OpenScenarioCommand}" Modifiers="Control" Key="O" />
  </r:RibbonWindow.InputBindings>
  <i:Interaction.Triggers>
    <i:EventTrigger EventName="Closing">
      <cinch:EventToCommandTrigger Command="{Binding ViewClosingCommand}" />
    </i:EventTrigger>
    <i:EventTrigger EventName="Activated">
      <cinch:EventToCommandTrigger Command="{Binding ViewActivatedCommand}" />
    </i:EventTrigger>
    <i:EventTrigger EventName="PreviewKeyDown">
      <cinch:EventToCommandTrigger Command="{Binding PreviewKeyDownCommand}" />
    </i:EventTrigger>
  </i:Interaction.Triggers>
  <DockPanel LastChildFill="True">
    <StatusBar DockPanel.Dock="Bottom">
      <StatusBarItem HorizontalAlignment="Left">
        <TextBlock Text="{Binding MouseLocationInfo}" />
      </StatusBarItem>
    </StatusBar>
    <!-- SelectedIndex="{Binding Source={x:Static p:Settings.Default}, Path=SelectedRibbonTabIndex, Mode=TwoWay}" -->
    <r:Ribbon x:Name="Ribbon" SelectedIndex="{Binding SelectedRibbonTabIndex}" DockPanel.Dock="Top">
      <r:Ribbon.ApplicationMenu>
        <r:RibbonApplicationMenu SmallImageSource="..\Images\SmallIcons\Wave.png">
          <r:RibbonApplicationMenuItem Header="Open Scenario" InputGestureText="Ctrl+O"
                                       ImageSource="..\Images\LargeIcons\open-icon.png" ToolTipTitle="{Binding Header, RelativeSource={RelativeSource Self}}"
                                       ToolTipDescription="Open a scenario file" Command="{Binding OpenScenarioCommand}" />
          <r:RibbonApplicationMenuItem Header="New Scenario" InputGestureText="Ctrl+N"
                                       ImageSource="..\Images\LargeIcons\new-icon.png" ToolTipTitle="{Binding Header, RelativeSource={RelativeSource Self}}"
                                       ToolTipDescription="Create a new scenario" Command="{Binding NewScenarioCommand}" />
          <r:RibbonApplicationMenuItem Header="Close Scenario" ImageSource="..\Images\LargeIcons\close-icon.png"
                                       ToolTipTitle="{Binding Header, RelativeSource={RelativeSource Self}}"
                                       ToolTipDescription="Close the current scenario file" Command="{Binding CloseScenarioCommand}" />
          <r:RibbonApplicationMenuItem Header="About" ImageSource="..\Images\LargeIcons\about-icon.png"
                                       ToolTipTitle="{Binding Header, RelativeSource={RelativeSource Self}}"
                                       ToolTipDescription="Information about the One Navy Model" Command="{Binding AboutCommand}" />
          <r:RibbonSeparator />
          <r:RibbonApplicationMenuItem Header="Options" ImageSource="..\Images\LargeIcons\gear-icon.png"
                                       ToolTipTitle="{Binding Header, RelativeSource={RelativeSource Self}}"
                                       ToolTipDescription="Edit application options and settings" Command="{Binding EditOptionsCommand}" />
          <r:RibbonApplicationMenuItem Header="Help" ImageSource="..\Images\LargeIcons\Button-Help-icon.png"
                                       ToolTipTitle="{Binding Header, RelativeSource={RelativeSource Self}}"
                                       ToolTipDescription="Opens the user manual for the One Navy Model" Command="{Binding HelpCommand}" />
          <r:RibbonSeparator />
          <r:RibbonApplicationMenuItem Header="Exit" ImageSource="..\Images\LargeIcons\Button-Close-icon.png"
                                       ToolTipTitle="{Binding Header, RelativeSource={RelativeSource Self}}" ToolTipDescription="Close the One Navy Model"
                                       Command="Close" />

          <r:RibbonApplicationMenu.AuxiliaryPaneContent>
            <Grid>
              <Grid.RowDefinitions>
                <RowDefinition Height="Auto" />
                <RowDefinition Height="5" />
                <RowDefinition Height="*" />
              </Grid.RowDefinitions>
              <r:RibbonSeparator Grid.Row="0" Label="Recent Scenarios" />
              <r:RibbonGallery ScrollViewer.VerticalScrollBarVisibility="Auto" Grid.Row="2"
                               SelectedItem="{Binding RecentFilesSelectedItem}" CanUserFilter="False">
                <r:RibbonGalleryCategory ItemsSource="{Binding RecentFiles.List}" Background="Transparent">
                  <r:RibbonGalleryCategory.ItemsPanel>
                    <ItemsPanelTemplate>
                      <StackPanel Orientation="Vertical" IsItemsHost="True"></StackPanel>
                    </ItemsPanelTemplate>
                  </r:RibbonGalleryCategory.ItemsPanel>
                  <r:RibbonGalleryCategory.ItemTemplate>
                    <DataTemplate>
                      <TextBlock Text="{Binding ShortName}" />
                    </DataTemplate>
                  </r:RibbonGalleryCategory.ItemTemplate>
                  <r:RibbonGalleryCategory.Style>
                    <Style></Style>
                  </r:RibbonGalleryCategory.Style>
                </r:RibbonGalleryCategory>
              </r:RibbonGallery>
            </Grid>
          </r:RibbonApplicationMenu.AuxiliaryPaneContent>
        </r:RibbonApplicationMenu>
      </r:Ribbon.ApplicationMenu>
      <r:RibbonTab KeyTip="H" Header="Home">
        <r:RibbonGroup Header="Overlays">
          <r:RibbonCheckBox Label="Lat/Lon Grid" ToolTipTitle="{Binding Label, RelativeSource={RelativeSource Self}}"
                            ToolTipDescription="Shows and hides the latitude/longitude grid overlay on the map"
                            IsChecked="{Binding IsLatLonGridVisible}" />
          <r:RibbonCheckBox Label="Pan &amp; Zoom" ToolTipTitle="{Binding Label, RelativeSource={RelativeSource Self}}"
                            ToolTipDescription="Shows and hides the pan/zoom control overlay on the map" IsChecked="{Binding IsPanZoomVisible}" />
          <r:RibbonCheckBox Label="Scale Bar" ToolTipTitle="{Binding Label, RelativeSource={RelativeSource Self}}"
                            ToolTipDescription="Shows and hides the scale bar overlay on the map" IsChecked="{Binding IsScaleBarVisible}" />
        </r:RibbonGroup>
        <r:RibbonGroup Header="Scenario">
          <r:RibbonButton Label="Open" LargeImageSource="..\Images\LargeIcons\open-icon.png"
                          SmallImageSource="..\Images\SmallIcons\open-icon.png"
                          ToolTipTitle="{Binding Label, RelativeSource={RelativeSource Self}}"
                          ToolTipDescription="Associate a scenario file with the current experiment" Command="{Binding OpenScenarioCommand}" />
          <r:RibbonButton Label="New" SmallImageSource="..\Images\SmallIcons\new-icon.png"
                          ToolTipTitle="{Binding Label, RelativeSource={RelativeSource Self}}" ToolTipDescription="Create a new scenario"
                          Command="{Binding NewScenarioCommand}" />
          <r:RibbonButton Label="Edit" SmallImageSource="..\Images\SmallIcons\application-icon.png"
                          ToolTipTitle="{Binding Label, RelativeSource={RelativeSource Self}}" ToolTipDescription="Launch the scenario editor"
                          IsEnabled="{Binding IsScenarioLoaded}" Command="{Binding ScenarioMetadata.EditScenarioCommand}" />
          <r:RibbonButton Label="Zoom" SmallImageSource="..\Images\SmallIcons\Magnifying-Glass-icon.png"
                          ToolTipTitle="{Binding Label, RelativeSource={RelativeSource Self}}"
                          ToolTipDescription="Resets the map position to the current scenario" IsEnabled="{Binding IsScenarioLoaded}"
                          Command="{Binding ScenarioMetadata.ZoomToScenarioCommand}" />
        </r:RibbonGroup>
        <r:RibbonGroup Header="Acoustics">
          <r:RibbonButton Label="Export" LargeImageSource="..\Images\LargeIcons\hourglass_go.png"
                          SmallImageSource="..\Images\SmallIcons\export-icon.png"
                          ToolTipTitle="{Binding Label, RelativeSource={RelativeSource Self}}"
                          ToolTipDescription="Export all Analysis Points to be calculated by the various acoustic models (configure the models using the Models button)"
                          Command="{Binding ExportAnalysisPointsCommand}" />
          <r:RibbonToggleButton Label="Analysis Point" SmallImageSource="..\Images\SmallIcons\location_pin.png"
                                ToolTipTitle="{Binding Label, RelativeSource={RelativeSource Self}}"
                                ToolTipDescription="Add a new analysis point to the experiment" IsEnabled="{Binding CanPlaceAnalysisPoint}"
                                IsChecked="{Binding IsInAnalysisPointMode}" />
          <r:RibbonButton Label="Models" SmallImageSource="..\Images\SmallIcons\chart_curve_edit.png"
                          ToolTipTitle="{Binding Label, RelativeSource={RelativeSource Self}}"
                          ToolTipDescription="Choose an acoustic model for each distinct mode in the scenario"
                          IsEnabled="{Binding IsScenarioLoaded}" Command="{Binding ConfigureAcousticModelsCommand}" />
          <r:RibbonButton Label="Re-verify" SmallImageSource="..\Images\SmallIcons\update.png"
                          ToolTipTitle="{Binding Label, RelativeSource={RelativeSource Self}}"
                          ToolTipDescription="Force reverification of acoustic fields in this scenario" IsEnabled="{Binding IsScenarioLoaded}"
                          Command="{Binding ReverifyAcousticModelsCommand}" />
        </r:RibbonGroup>
      </r:RibbonTab>
      <r:RibbonTab KeyTip="V" Header="Environment">
        <r:RibbonGroup Header="Map">
          <r:RibbonButton Label="World Map" LargeImageSource="..\Images\LargeIcons\globe-icon.png"
                          SmallImageSource="..\Images\SmallIcons\globe-icon.png" Command="{Binding ZoomToWorldMapCommand}" />
        </r:RibbonGroup>
        <r:RibbonGroup Header="Range Complex" ToolTip="{Binding ScenarioLoadedToolTip}">
          <ListView Width="150" Height="66" ItemsSource="{Binding RangeComplexes.RangeComplexList}"
                    IsEnabled="{Binding IsScenarioLoaded, Converter={StaticResource NegatingConverter}}"
                    SelectedItem="{Binding RangeComplexes.SelectedRangeComplex}"
                    SelectedIndex="{Binding RangeComplexes.SelectedRangeComplexIndex}" DisplayMemberPath="Name"
                    ScrollViewer.HorizontalScrollBarVisibility="Disabled" SelectionMode="Single">
            <ListView.ItemsPanel>
              <ItemsPanelTemplate>
                <StackPanel />
              </ItemsPanelTemplate>
            </ListView.ItemsPanel>
          </ListView>
          <r:RibbonButton Label="New" LargeImageSource="..\Images\LargeIcons\world_add.png"
                          SmallImageSource="..\Images\SmallIcons\world_add.png"
                          IsEnabled="{Binding IsScenarioLoaded, Converter={StaticResource NegatingConverter}}" ToolTipTitle="New range complex"
                          ToolTipDescription="Define a new range complex" Command="{Binding NewRangeComplexCommand}" />
          <r:RibbonButton SmallImageSource="..\Images\SmallIcons\world_go.png" ToolTipTitle="Show range complex"
                          IsEnabled="{Binding IsScenarioLoaded, Converter={StaticResource NegatingConverter}}"
                          ToolTipDescription="Show the selected range complex on the map" Command="{Binding ZoomToRangeComplexCommand}" />
          <r:RibbonButton SmallImageSource="..\Images\SmallIcons\world_delete.png" ToolTipTitle="Delete range complex"
                          IsEnabled="{Binding IsScenarioLoaded, Converter={StaticResource NegatingConverter}}"
                          ToolTipDescription="Delete the selected range complex, and all data within it"
                          Command="{Binding DeleteRangeComplexCommand}" />
          <r:RibbonButton SmallImageSource="..\Images\SmallIcons\arrow_undo.png" ToolTipTitle="Clear selection"
                          IsEnabled="{Binding IsScenarioLoaded, Converter={StaticResource NegatingConverter}}"
                          ToolTipDescription="Clear the currently selected range complex" Command="{Binding ClearRangeComplexSelectionCommand}" />
          <r:RibbonButton SmallImageSource="..\Images\SmallIcons\arrow_refresh.png"
                          ToolTipTitle="Re-import range complex"
                          IsEnabled="{Binding IsScenarioLoaded, Converter={StaticResource NegatingConverter}}"
                          ToolTipDescription="Re-import all environment data for the current range complex"
                          Command="{Binding ReimportRangeComplexCommand}" />
        </r:RibbonGroup>
        <r:RibbonGroup Header="Time Period" ToolTip="{Binding ScenarioLoadedToolTip}">
          <ListView Width="80" Height="66" ItemsSource="{x:Static NAVO:NAVOConfiguration.AllTimePeriods}"
                    IsEnabled="{Binding IsScenarioLoaded, Converter={StaticResource NegatingConverter}}"
                    SelectedItem="{Binding RangeComplexes.SelectedTimePeriod}"
                    SelectedIndex="{Binding RangeComplexes.SelectedTimePeriodIndex}" ScrollViewer.HorizontalScrollBarVisibility="Disabled"
                    SelectionMode="Single">
            <ListView.ItemsPanel>
              <ItemsPanelTemplate>
                <StackPanel />
              </ItemsPanelTemplate>
            </ListView.ItemsPanel>
          </ListView>
        </r:RibbonGroup>
        <r:RibbonGroup Header="Area">
          <ListView Width="200" Height="66" ItemsSource="{Binding RangeComplexes.SelectedRangeComplex.AreaList}"
                    IsEnabled="{Binding RangeComplexes.SelectedRangeComplex, Converter={StaticResource NotNull}}"
                    SelectedItem="{Binding RangeComplexes.SelectedArea}" SelectedIndex="{Binding RangeComplexes.SelectedAreaIndex}"
                    DisplayMemberPath="Name" ScrollViewer.HorizontalScrollBarVisibility="Disabled" ToolTip="Select a simulation area"
                    SelectionMode="Single">
            <ListView.ItemsPanel>
              <ItemsPanelTemplate>
                <StackPanel />
              </ItemsPanelTemplate>
            </ListView.ItemsPanel>
          </ListView>
          <r:RibbonButton Label="Expand" LargeImageSource="..\Images\LargeIcons\canvas_size.png"
                          SmallImageSource="..\Images\SmallIcons\canvas_size.png" ToolTipTitle="Expand area"
                          ToolTipDescription="Create a new overlay by expanding the selected overlay"
                          ToolTipFooterDescription="Note: You cannot expand an overlay that was previously created by expanding another overlay"
                          Command="{Binding ExpandOverlayCommand}" />
          <r:RibbonButton SmallImageSource="..\Images\SmallIcons\overlay-new.png" ToolTipTitle="New Area"
                          ToolTipDescription="Create a new area in the current range complex" Command="{Binding NewOverlayCommand}" />
          <r:RibbonButton SmallImageSource="..\Images\SmallIcons\Button-Close-icon.png" ToolTipTitle="Delete area"
                          ToolTipDescription="Delete the selected area from the current range complex"
                          ToolTipFooterDescription="Note: Operational and simulation limit overlays for the currently selected range complex cannot be deleted."
                          IsEnabled="{Binding RangeComplexes.SelectedArea.CanBeDeleted}" Command="{Binding DeleteOverlayCommand}" />
          <r:RibbonButton SmallImageSource="..\Images\SmallIcons\arrow_undo.png"
                          ToolTipTitle="Clear the currently selected area" ToolTipDescription="Clear the currently selected area"
                          Command="{Binding ClearAreaSelectionCommand}" />
        </r:RibbonGroup>
        <r:RibbonGroup Header="Bathymetry">
          <ListView Width="75" Height="66" ItemContainerStyle="{StaticResource DataCachedDisplayStyle}"
                    IsEnabled="{Binding RangeComplexes.SelectedRangeComplex, Converter={StaticResource NotNull}}"
                    ItemsSource="{Binding RangeComplexes.SelectedArea.BathymetryList}"
                    SelectedItem="{Binding RangeComplexes.SelectedBathymetry}"
                    SelectedIndex="{Binding RangeComplexes.SelectedBathymetryIndex}" DisplayMemberPath="Name"
                    ScrollViewer.HorizontalScrollBarVisibility="Disabled" ToolTip="Select a simulation area" SelectionMode="Single" />
          <r:RibbonButton Label="Add" LargeImageSource="..\Images\LargeIcons\map_add.png"
                          SmallImageSource="..\Images\SmallIcons\map_add.png" ToolTipTitle="New Bathymetry"
                          ToolTipDescription="Extract a new bathymetry dataset" Command="{Binding AddBathymetryCommand}" />
          <r:RibbonButton SmallImageSource="..\Images\SmallIcons\map_delete.png" ToolTipTitle="Delete bathymetry"
                          ToolTipDescription="Delete the selected bathymetry dataset" Command="{Binding RemoveBathymetryCommand}" />
          <r:RibbonButton SmallImageSource="..\Images\SmallIcons\arrow_refresh.png" ToolTipTitle="Re-import bathymetry"
                          ToolTipDescription="Re-import the selected bathymetry dataset" Command="{Binding ReloadBathymetryCommand}" />
          <r:RibbonButton SmallImageSource="..\Images\SmallIcons\arrow_undo.png" ToolTipTitle="Clear selection"
                          ToolTipDescription="Clear the currently selected bathymetry" Command="{Binding ClearBathymetrySelectionCommand}" />
        </r:RibbonGroup>
        <r:RibbonGroup Header="Export">
          <r:RibbonButton Label="Export" LargeImageSource="..\Images\LargeIcons\export-icon.png" ToolTipTitle="Export"
                          ToolTipDescription="Write the currently selected environmental data to disk." Command="{Binding ExportAllEnvironmentalDataCommand}" />
        </r:RibbonGroup>
            </r:RibbonTab>

      <r:RibbonTab KeyTip="S" Header="Simulation">
        <r:RibbonGroup Header="Simulators">
          <r:RibbonButton Label="Acoustic Simulator"
                          ToolTipTitle="{Binding Label, RelativeSource={RelativeSource Self}}"
                          LargeImageSource="..\Images\LargeIcons\orbz_water.png" SmallImageSource="..\Images\SmallIcons\orbz_water.png"
                          ToolTipDescription="Runs the Acoustic Simulator. The icon will appear in your system tray."
                          Command="{Binding RunTransmissionLossCalculatorCommand}" />
          <r:RibbonButton Label="Scenario (Interactive)" LargeImageSource="..\Images\LargeIcons\Button-Play-icon.png"
                          SmallImageSource="..\Images\SmallIcons\Button-Play-icon.png"
                          ToolTipTitle="{Binding Label, RelativeSource={RelativeSource Self}}"
                          ToolTipDescription="Run the scenario in interactive mode" IsEnabled="{Binding IsScenarioLoaded}"
                          Command="{Binding RunScenarioGUICommand}" />
          <r:RibbonButton Label="Scenario (Batch)" LargeImageSource="..\Images\LargeIcons\Button-Play-icon.png"
                          SmallImageSource="..\Images\SmallIcons\Button-Play-icon.png"
                          ToolTipTitle="{Binding Label, RelativeSource={RelativeSource Self}}"
                          ToolTipDescription="Run the scenario in batch mode" IsEnabled="{Binding IsScenarioLoaded}"
                          Command="{Binding RunScenarioCommand}" />
          <r:RibbonButton Label="Scenario Post Processor"
                          ToolTipTitle="{Binding Label, RelativeSource={RelativeSource Self}}"
                          SmallImageSource="..\Images\SmallIcons\chart-icon.png" LargeImageSource="..\Images\LargeIcons\chart-icon.png"
                          ToolTipDescription="Launches the NUWC Scenario Post Processor" Command="{Binding LaunchScenarioPostProcessorCommand}" />
          <r:RibbonButton Label="Exposure Report Generator"
                          ToolTipTitle="{Binding Label, RelativeSource={RelativeSource Self}}"
                          SmallImageSource="..\Images\SmallIcons\chart-icon.png" LargeImageSource="..\Images\LargeIcons\chart-icon.png"
                          ToolTipDescription="Launches the NUWC Report Generator" Command="{Binding LaunchExposureReportGeneratorCommand}" />
        </r:RibbonGroup>
        <r:RibbonGroup Header="Log files">
          <r:RibbonButton Label="Viewer" LargeImageSource="..\Images\LargeIcons\log-icon.png"
                          SmallImageSource="..\Images\SmallIcons\log-icon.png"
                          ToolTipTitle="{Binding Label, RelativeSource={RelativeSource Self}}"
                          ToolTipDescription="Watch the log file of the scenario simulator" Command="{Binding ViewSimulatorLogsCommand}" />
        </r:RibbonGroup>
        <r:RibbonGroup Header="Animals">
          <r:RibbonButton Label="MMMBS" ToolTipTitle="{Binding Label, RelativeSource={RelativeSource Self}}"
                          ToolTipDescription="Launch the Marine Mammal Movement and Behavior Simulator to define animat populations."
                          SmallImageSource="..\Images\3mbNewIcon.ico" LargeImageSource="..\Images\3mbNewIcon.ico"
                          IsEnabled="{Binding IsScenarioLoaded}" Command="{Binding LaunchMMMBSCommand}" />
          <r:RibbonButton Label="Export Bathymetry File" SmallImageSource="..\Images\SmallIcons\export-icon.png"
                          ToolTipTitle="{Binding Label, RelativeSource={RelativeSource Self}}"
                          ToolTipDescription="Create a bathymetry file that will be loaded by MMMBS" 
                          Command="{Binding CreateMMMBSBathymetryFileCommand}" />
        </r:RibbonGroup>
      </r:RibbonTab>
    </r:Ribbon>
    <Grid>
      <Grid.ColumnDefinitions>
        <ColumnDefinition
Width="{Binding Source={x:Static p:Settings.Default}, Path=LayersWidth, Mode=TwoWay, Converter={StaticResource GridLengthConverter}}" />
        <ColumnDefinition Width="Auto" />
        <ColumnDefinition Width="*" MinWidth="500" />
      </Grid.ColumnDefinitions>
      <TabControl SelectedIndex="{Binding SelectedSidebarTabIndex}">
        <TabItem Header="Map Layers">
          <LocalControls:LayerListView />
        </TabItem>
        <TabItem Header="Scenario View"
                 Visibility="{Binding IsScenarioLoaded, Converter={StaticResource TrueVisibleFalseCollapsed}}">
          <LocalControls:LayerTreeView />
        </TabItem>
        <TabItem Header="Environment Explorer"
                 Visibility="{Binding IsEnvironmentTabSelected, Converter={StaticResource TrueVisibleFalseCollapsed}}">
          <DockPanel LastChildFill="True">
            <GroupBox Header="Import status" Margin="5" DockPanel.Dock="Bottom">
              <EnvironmentBuilder:ImportProgressListView ItemsSource="{Binding ImportProgressCollection}" />
            </GroupBox>
            <GroupBox Header="Range Complexes" Margin="5" DockPanel.Dock="Top" HorizontalAlignment="Stretch"
                      VerticalAlignment="Stretch">
              <EnvironmentBuilder:RangeComplexTreeView DockPanel.Dock="Top" DataContext="{Binding RangeComplexes}"
                                                       IsEnabled="{Binding IsEnabled}"
                                                       ItemsSource="{Binding RangeComplexList, Converter={StaticResource SortConverter}, ConverterParameter='Name'}" />
            </GroupBox>
          </DockPanel>
        </TabItem>
      </TabControl>
      <GridSplitter Grid.Column="1" Width="2" Background="Black" HorizontalAlignment="Center" Margin="5,0,5,0"
                    VerticalAlignment="Stretch" ResizeBehavior="BasedOnAlignment" ResizeDirection="Columns" />
      <LocalControls:MapView Grid.Column="2" />
      <i:Interaction.Triggers>
        <i:EventTrigger EventName="Drop">
          <ia:CallMethodAction TargetObject="{Binding}" MethodName="FilesDropped" />
        </i:EventTrigger>
      </i:Interaction.Triggers>
    </Grid>
  </DockPanel>
</r:RibbonWindow>