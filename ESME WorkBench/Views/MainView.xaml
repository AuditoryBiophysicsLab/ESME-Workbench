<r:RibbonWindow x:Class="ESMEWorkBench.Views.MainView"
                xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
                xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
                xmlns:r="clr-namespace:Microsoft.Windows.Controls.Ribbon;assembly=RibbonControlsLibrary"
                xmlns:mef="http:\\www.codeplex.com\MEFedMVVM" xmlns:cinch="clr-namespace:Cinch;assembly=Cinch.WPF"
                xmlns:p="clr-namespace:ESMEWorkBench.Properties" xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
                xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
                xmlns:i="http://schemas.microsoft.com/expression/2010/interactivity"
                xmlns:ia="http://schemas.microsoft.com/expression/2010/interactions"
                xmlns:LocalControls="clr-namespace:ESMEWorkBench.Controls" xmlns:WPF="clr-namespace:HRC.WPF;assembly=HRC"
                xmlns:Main="clr-namespace:ESMEWorkBench.ViewModels.Main"
                xmlns:EnvironmentBuilder="clr-namespace:ESME.Views.EnvironmentBuilder;assembly=ESME.Views"
                xmlns:NAVO="clr-namespace:ESME.Environment.NAVO;assembly=ESME" xmlns:System="clr-namespace:System;assembly=mscorlib"
                mef:ViewModelLocator.ViewModel="MainViewModel" SnapsToDevicePixels="True" Title="{Binding MainWindowTitle}"
                Icon="..\Wave.ico" Top="{Binding Source={x:Static p:Settings.Default}, Path=WindowTop, Mode=TwoWay}"
                Left="{Binding Source={x:Static p:Settings.Default}, Path=WindowLeft, Mode=TwoWay}"
                Height="{Binding Source={x:Static p:Settings.Default}, Path=WindowHeight, Mode=TwoWay}"
                Width="{Binding Source={x:Static p:Settings.Default}, Path=WindowWidth, Mode=TwoWay}" d:DesignWidth="1000"
                d:DesignHeight="800" mc:Ignorable="d" d:DataContext="{d:DesignInstance Type=Main:MainViewModel}">
  <r:RibbonWindow.Resources>
    <WPF:GridLengthConverter x:Key="gridLengthConverter" />
  </r:RibbonWindow.Resources>
  <r:RibbonWindow.InputBindings>
    <KeyBinding Command="{Binding CancelCurrentCommand}" Key="Escape" />
    <KeyBinding Command="{Binding OpenScenarioCommand}" Modifiers="Control" Key="O" />
  </r:RibbonWindow.InputBindings>
  <i:Interaction.Triggers>
    <i:EventTrigger EventName="Closing">
      <cinch:EventToCommandTrigger Command="{Binding ViewClosingCommand}" />
    </i:EventTrigger>
    <i:EventTrigger EventName="Activated">
      <cinch:EventToCommandTrigger Command="{Binding ViewActivatedCommand}" />
    </i:EventTrigger>
    <i:EventTrigger EventName="PreviewKeyDown">
      <cinch:EventToCommandTrigger Command="{Binding PreviewKeyDownCommand}" />
    </i:EventTrigger>
  </i:Interaction.Triggers>
  <DockPanel LastChildFill="True">
    <StatusBar DockPanel.Dock="Bottom">
      <StatusBarItem HorizontalAlignment="Left">
        <StackPanel Orientation="Horizontal">
          <TextBlock Text="{Binding MouseEarthCoordinate.Latitude, StringFormat=Lat: {0:0.000000}}" />
          <TextBlock Text=" " />
          <TextBlock Text="{Binding MouseEarthCoordinate.Longitude, StringFormat=Lon: {0:0.000000}}" />
          <TextBlock Text=" " />
          <TextBlock Text="{Binding MouseDepth, StringFormat=Depth: {0:0.0}}" />
        </StackPanel>
      </StatusBarItem>
      <StatusBarItem HorizontalAlignment="Right"
                     Visibility="{Binding BackgroundTaskAggregator.IsRunning, Converter={StaticResource TrueVisibleFalseCollapsed}}">
        <ProgressBar Minimum="{Binding Path=BackgroundTaskAggregator.Minimum}"
                     Maximum="{Binding Path=BackgroundTaskAggregator.Maximum}" Value="{Binding Path=BackgroundTaskAggregator.Value}"
                     ToolTip="{Binding Path=BackgroundTaskAggregator.Status}" Height="22" Width="50">
          <ProgressBar.ContextMenu>
            <ContextMenu IsEnabled="{Binding BackgroundTaskAggregator.IsRunning}">
              <MenuItem Header="Show detailed progress" Command="{Binding ShowDetailedProgressCommand}" />
            </ContextMenu>
          </ProgressBar.ContextMenu>
        </ProgressBar>
      </StatusBarItem>
    </StatusBar>
    <r:Ribbon x:Name="Ribbon" SelectedIndex="{Binding SelectedRibbonTabIndex, Mode=TwoWay}" DockPanel.Dock="Top">
      <!-- <r:Ribbon x:Name="Ribbon" SelectedIndex="2" DockPanel.Dock="Top"> -->
      <r:Ribbon.ApplicationMenu>
        <r:RibbonApplicationMenu SmallImageSource="..\Images\SmallIcons\Wave.png">
          <r:RibbonApplicationMenuItem Header="Open Scenario" InputGestureText="Ctrl+O"
                                       ImageSource="..\Images\LargeIcons\open-icon.png" ToolTipTitle="{Binding Header, RelativeSource={RelativeSource Self}}"
                                       ToolTipDescription="Open a scenario file" Command="{Binding OpenScenarioCommand}" />
          <r:RibbonApplicationMenuItem Header="New Scenario" InputGestureText="Ctrl+N"
                                       ImageSource="..\Images\LargeIcons\new-icon.png" ToolTipTitle="{Binding Header, RelativeSource={RelativeSource Self}}"
                                       ToolTipDescription="Create a new scenario" Command="{Binding NewScenarioCommand}" />
          <r:RibbonApplicationMenuItem Header="Close Scenario" ImageSource="..\Images\LargeIcons\close-icon.png"
                                       ToolTipTitle="{Binding Header, RelativeSource={RelativeSource Self}}"
                                       ToolTipDescription="Close the current scenario file" Command="{Binding CloseScenarioCommand}" />
          <r:RibbonApplicationMenuItem Header="About" ImageSource="..\Images\LargeIcons\about-icon.png"
                                       ToolTipTitle="{Binding Header, RelativeSource={RelativeSource Self}}"
                                       ToolTipDescription="Information about ESME WorkBench 2011" Command="{Binding AboutCommand}" />
          <r:RibbonSeparator />
          <r:RibbonApplicationMenuItem Header="Options" ImageSource="..\Images\LargeIcons\gear-icon.png"
                                       ToolTipTitle="{Binding Header, RelativeSource={RelativeSource Self}}"
                                       ToolTipDescription="Edit application options and settings" Command="{Binding EditOptionsCommand}" />
          <r:RibbonApplicationMenuItem Header="Help" ImageSource="..\Images\LargeIcons\Button-Help-icon.png"
                                       ToolTipTitle="{Binding Header, RelativeSource={RelativeSource Self}}"
                                       ToolTipDescription="Opens the user manual for ESME WorkBench 2011" Command="{Binding HelpCommand}" />
          <r:RibbonSeparator />
          <r:RibbonApplicationMenuItem Header="Exit" ImageSource="..\Images\LargeIcons\Button-Close-icon.png"
                                       ToolTipTitle="{Binding Header, RelativeSource={RelativeSource Self}}" ToolTipDescription="Close the ESME WorkBench"
                                       Command="Close" />

          <r:RibbonApplicationMenu.AuxiliaryPaneContent>
            <Grid>
              <Grid.RowDefinitions>
                <RowDefinition Height="Auto" />
                <RowDefinition Height="5" />
                <RowDefinition Height="*" />
              </Grid.RowDefinitions>
              <r:RibbonSeparator Grid.Row="0" Label="Recent Scenarios" />
              <r:RibbonGallery ScrollViewer.VerticalScrollBarVisibility="Auto" Grid.Row="2"
                               SelectedItem="{Binding RecentFilesSelectedItem}" CanUserFilter="False">
                <r:RibbonGalleryCategory ItemsSource="{Binding RecentFiles.List}" Background="Transparent">
                  <r:RibbonGalleryCategory.ItemsPanel>
                    <ItemsPanelTemplate>
                      <StackPanel Orientation="Vertical" IsItemsHost="True"></StackPanel>
                    </ItemsPanelTemplate>
                  </r:RibbonGalleryCategory.ItemsPanel>
                  <r:RibbonGalleryCategory.ItemTemplate>
                    <DataTemplate>
                      <TextBlock Text="{Binding ShortName}" />
                    </DataTemplate>
                  </r:RibbonGalleryCategory.ItemTemplate>
                  <r:RibbonGalleryCategory.Style>
                    <Style></Style>
                  </r:RibbonGalleryCategory.Style>
                </r:RibbonGalleryCategory>
              </r:RibbonGallery>
            </Grid>
          </r:RibbonApplicationMenu.AuxiliaryPaneContent>
        </r:RibbonApplicationMenu>
      </r:Ribbon.ApplicationMenu>
      <r:RibbonTab KeyTip="H" Header="Home">
        <r:RibbonGroup Header="Overlays">
          <r:RibbonCheckBox Label="Lat/Lon Grid" ToolTipTitle="{Binding Label, RelativeSource={RelativeSource Self}}"
                            ToolTipDescription="Shows and hides the latitude/longitude grid overlay on the map"
                            IsChecked="{Binding IsLatLonGridVisible}" />
          <r:RibbonCheckBox Label="Pan &amp; Zoom" ToolTipTitle="{Binding Label, RelativeSource={RelativeSource Self}}"
                            ToolTipDescription="Shows and hides the pan/zoom control overlay on the map" IsChecked="{Binding IsPanZoomVisible}" />
          <r:RibbonCheckBox Label="Scale Bar" ToolTipTitle="{Binding Label, RelativeSource={RelativeSource Self}}"
                            ToolTipDescription="Shows and hides the scale bar overlay on the map" IsChecked="{Binding IsScaleBarVisible}" />
        </r:RibbonGroup>
        <r:RibbonGroup Header="Scenario">
          <r:RibbonButton Label="Open" LargeImageSource="..\Images\LargeIcons\open-icon.png"
                          SmallImageSource="..\Images\SmallIcons\open-icon.png"
                          ToolTipTitle="{Binding Label, RelativeSource={RelativeSource Self}}"
                          ToolTipDescription="Associate a scenario file with the current experiment" Command="{Binding OpenScenarioCommand}" />
          <r:RibbonButton Label="New" SmallImageSource="..\Images\SmallIcons\new-icon.png"
                          ToolTipTitle="{Binding Label, RelativeSource={RelativeSource Self}}" ToolTipDescription="Create a new scenario"
                          IsEnabled="{Binding IsScenarioLoaded}" Command="{Binding NewScenarioCommand}" />
          <r:RibbonButton Label="Edit" SmallImageSource="..\Images\SmallIcons\application-icon.png"
                          ToolTipTitle="{Binding Label, RelativeSource={RelativeSource Self}}" ToolTipDescription="Launch the scenario editor"
                          IsEnabled="{Binding IsScenarioLoaded}" Command="{Binding ScenarioMetadata.EditScenarioCommand}" />
          <r:RibbonButton Label="Zoom" SmallImageSource="..\Images\SmallIcons\Magnifying-Glass-icon.png"
                          ToolTipTitle="{Binding Label, RelativeSource={RelativeSource Self}}"
                          ToolTipDescription="Resets the map position to the current scenario" IsEnabled="{Binding IsScenarioLoaded}"
                          Command="{Binding ScenarioMetadata.ZoomToScenarioCommand}" />
        </r:RibbonGroup>
        <r:RibbonGroup Header="Environment">
          <!--
          <r:RibbonComboBox SmallImageSource="..\Images\SmallIcons\World-icon.png" SelectionBoxWidth="62"
                            VerticalAlignment="Center" IsEditable="False" ToolTip="Select a range complex">
            <r:RibbonGallery SelectedValue="{Binding RangeComplexes.SelectedRangeComplex}">
              <r:RibbonGallery.Items>
                <r:RibbonGalleryCategory ItemsSource="{Binding RangeComplexes.RangeComplexList, Mode=OneWay}"
                                         DisplayMemberPath="Name" />
              </r:RibbonGallery.Items>
            </r:RibbonGallery>
          </r:RibbonComboBox>
          <r:RibbonComboBox SmallImageSource="..\Images\SmallIcons\calendar_view_month.png" SelectionBoxWidth="62"
                            VerticalAlignment="Center" IsEditable="False" ToolTip="Select a time period for the simulation">
            <r:RibbonGallery SelectedValue="{Binding RangeComplexes.SelectedTimePeriod}">
              <r:RibbonGallery.Items>
                <r:RibbonGalleryCategory ItemsSource="{x:Static NAVO:NAVOConfiguration.AllTimePeriods}" />
              </r:RibbonGallery.Items>
            </r:RibbonGallery>
          </r:RibbonComboBox>
            -->
                    <Grid>
                        <Grid.RowDefinitions>
                            <RowDefinition />
                            <RowDefinition />
                        </Grid.RowDefinitions>
                        <r:RibbonControlGroup Grid.Row="0" HorizontalAlignment="Right">
            <r:RibbonComboBox Label="Area" SelectionBoxWidth="100" VerticalAlignment="Center"
                              IsEditable="False" ToolTip="Select a simulation area">
              <r:RibbonGallery SelectedValue="{Binding RangeComplexes.SelectedArea}">
                <r:RibbonGallery.Items>
                  <r:RibbonGalleryCategory ItemsSource="{Binding RangeComplexes.SelectedRangeComplex.AreaList}"
                                           DisplayMemberPath="Name" />
                </r:RibbonGallery.Items>
              </r:RibbonGallery>
            </r:RibbonComboBox>
            <r:RibbonButton SmallImageSource="..\Images\SmallIcons\canvas_size.png"
                            ToolTipTitle="{Binding Label, RelativeSource={RelativeSource Self}}"
                            ToolTipDescription="Create a new overlay by expanding the selected overlay"
                            ToolTipFooterDescription="Note: You cannot expand an overlay that was previously created by expanding another overlay"
                            Command="{Binding ExpandOverlayCommand}" />
            <r:RibbonButton SmallImageSource="..\Images\SmallIcons\overlay-new.png" ToolTipTitle="New Overlay"
                            ToolTipDescription="Create a new overlay" Command="{Binding NewOverlayCommand}" />
            <r:RibbonButton SmallImageSource="..\Images\SmallIcons\Button-Close-icon.png"
                            ToolTipTitle="{Binding Label, RelativeSource={RelativeSource Self}}"
                            ToolTipDescription="Delete the selected overlay, and all overlays, bathymetry and environment data that depends on it."
                            ToolTipFooterDescription="Note: Operational and simulation limit overlays for the currently selected range complex cannot be deleted."
                            IsEnabled="{Binding SelectedArea.CanBeDeleted}" Command="{Binding DeleteOverlayCommand}" />

          </r:RibbonControlGroup>
          <r:RibbonControlGroup Grid.Row="1" HorizontalAlignment="Right">
            <r:RibbonComboBox Label="Resolution" SelectionBoxWidth="100" VerticalAlignment="Center"
                              IsEditable="False" ToolTip="Select a bathymetry resolution">
              <r:RibbonGallery SelectedValue="{Binding RangeComplexes.SelectedBathymetry}">
                <r:RibbonGallery.Items>
                  <r:RibbonGalleryCategory ItemsSource="{Binding RangeComplexes.SelectedArea.BathymetryList}"
                                           DisplayMemberPath="Name" ItemContainerStyle="{StaticResource DataCachedDisplayStyle}" />
                </r:RibbonGallery.Items>
              </r:RibbonGallery>
            </r:RibbonComboBox>

            <r:RibbonButton SmallImageSource="..\Images\SmallIcons\map_add.png"
                            ToolTipTitle="New Bathymetry" ToolTipDescription="Extract a new bathymetry dataset"
                            Command="{Binding AddBathymetryCommand}" />
            <r:RibbonButton SmallImageSource="..\Images\SmallIcons\map_delete.png"
                            ToolTipTitle="{Binding Label, RelativeSource={RelativeSource Self}}"
                            ToolTipDescription="Delete the selected bathymetry dataset" Command="{Binding RemoveBathymetryCommand}" />
            <r:RibbonButton SmallImageSource="..\Images\SmallIcons\arrow_refresh.png"
                            ToolTipTitle="{Binding Label, RelativeSource={RelativeSource Self}}"
                            ToolTipDescription="Re-import the selected bathymetry dataset" Command="{Binding ReloadBathymetryCommand}" />


          </r:RibbonControlGroup>
            <!--
          <r:RibbonButton SmallImageSource="..\Images\SmallIcons\map_add.png" Label="Load selected"
                          Command="{Binding LoadEnvironmentCommand}" />
          <r:RibbonButton SmallImageSource="..\Images\SmallIcons\map_delete.png" Label="Clear selected"
                          Command="{Binding ClearEnvironmentCommand}" />
            -->
                    </Grid>
                </r:RibbonGroup>
        <r:RibbonGroup Header="Acoustics">
          <r:RibbonButton Label="Export" LargeImageSource="..\Images\LargeIcons\hourglass_go.png"
                          SmallImageSource="..\Images\SmallIcons\export-icon.png"
                          ToolTipTitle="{Binding Label, RelativeSource={RelativeSource Self}}"
                          ToolTipDescription="Export all Analysis Points to be calculated by the various acoustic models (configure the models using the Models button)"
                          Command="{Binding ExportAnalysisPointsCommand}" />
          <r:RibbonToggleButton Label="Analysis Point" SmallImageSource="..\Images\SmallIcons\location_pin.png"
                                ToolTipTitle="{Binding Label, RelativeSource={RelativeSource Self}}"
                                ToolTipDescription="Add a new analysis point to the experiment" IsEnabled="{Binding CanPlaceAnalysisPoint}"
                                IsChecked="{Binding IsInAnalysisPointMode}" />
          <r:RibbonButton Label="Models" SmallImageSource="..\Images\SmallIcons\chart_curve_edit.png"
                          ToolTipTitle="{Binding Label, RelativeSource={RelativeSource Self}}"
                          ToolTipDescription="Choose an acoustic model for each distinct mode in the scenario"
                          IsEnabled="{Binding IsScenarioLoaded}" Command="{Binding ConfigureAcousticModelsCommand}" />
        </r:RibbonGroup>
            
      </r:RibbonTab>
          
      <r:RibbonTab KeyTip="S" Header="Simulation">
        <r:RibbonGroup Header="Simulators">
          <r:RibbonButton Label="Acoustic Simulator"
                          ToolTipTitle="{Binding Label, RelativeSource={RelativeSource Self}}"
                          LargeImageSource="..\Images\LargeIcons\orbz_water.png" SmallImageSource="..\Images\SmallIcons\orbz_water.png"
                          ToolTipDescription="Runs the Acoustic Simulator. The icon will appear in your system tray."
                          Command="{Binding RunTransmissionLossCalculatorCommand}" />
          <r:RibbonButton Label="Scenario (Interactive)" LargeImageSource="..\Images\LargeIcons\Button-Play-icon.png"
                          SmallImageSource="..\Images\SmallIcons\Button-Play-icon.png"
                          ToolTipTitle="{Binding Label, RelativeSource={RelativeSource Self}}"
                          ToolTipDescription="Run the scenario in interactive mode" IsEnabled="{Binding IsScenarioLoaded}"
                          Command="{Binding RunScenarioGUICommand}" />
          <r:RibbonButton Label="Scenario (Batch)" LargeImageSource="..\Images\LargeIcons\Button-Play-icon.png"
                          SmallImageSource="..\Images\SmallIcons\Button-Play-icon.png"
                          ToolTipTitle="{Binding Label, RelativeSource={RelativeSource Self}}"
                          ToolTipDescription="Run the scenario in batch mode" IsEnabled="{Binding IsScenarioLoaded}"
                          Command="{Binding RunScenarioCommand}" />
          <r:RibbonButton Label="Scenario Post Processor"
                          ToolTipTitle="{Binding Label, RelativeSource={RelativeSource Self}}"
                          SmallImageSource="..\Images\SmallIcons\chart-icon.png" LargeImageSource="..\Images\LargeIcons\chart-icon.png"
                          ToolTipDescription="Launches the NUWC Scenario Post Processor" Command="{Binding LaunchScenarioPostProcessorCommand}" />
          <r:RibbonButton Label="Exposure Report Generator"
                          ToolTipTitle="{Binding Label, RelativeSource={RelativeSource Self}}"
                          SmallImageSource="..\Images\SmallIcons\chart-icon.png" LargeImageSource="..\Images\LargeIcons\chart-icon.png"
                          ToolTipDescription="Launches the NUWC Report Generator" Command="{Binding LaunchExposureReportGeneratorCommand}" />
        </r:RibbonGroup>
        <r:RibbonGroup Header="Log files">
          <r:RibbonButton Label="Viewer" LargeImageSource="..\Images\LargeIcons\log-icon.png"
                          SmallImageSource="..\Images\SmallIcons\log-icon.png"
                          ToolTipTitle="{Binding Label, RelativeSource={RelativeSource Self}}"
                          ToolTipDescription="Watch the log file of the scenario simulator" Command="{Binding ViewSimulatorLogsCommand}" />
        </r:RibbonGroup>
        <r:RibbonGroup Header="Animals">
          <r:RibbonButton Label="MMMBS" ToolTipTitle="{Binding Label, RelativeSource={RelativeSource Self}}"
                          ToolTipDescription="Launch the Marine Mammal Movement and Behavior Simulator to define animat populations."
                          SmallImageSource="..\Images\3mbNewIcon.ico" LargeImageSource="..\Images\3mbNewIcon.ico"
                          IsEnabled="{Binding IsScenarioLoaded}" Command="{Binding LaunchMMMBSCommand}" />
          <!--
                    <r:RibbonButton Label="Launch SpeciesBuilder"
					                ToolTipTitle="{Binding Label, RelativeSource={RelativeSource Self}}"
					                ToolTipDescription="Launches the Marine Mammal Movement and Behavior Simulator's Species File Editor"
					                SmallImageSource="..\Images\SmallIcons\Dolphin.png"
					                LargeImageSource="..\Images\LargeIcons\Dolphin.png"
					                Command="{Binding LaunchMMMBSpeciesBuilderCommand}" />
                    -->

          <r:RibbonButton Label="Export Bathymetry File"
                          SmallImageSource="..\Images\SmallIcons\export-icon.png"
                          ToolTipTitle="{Binding Label, RelativeSource={RelativeSource Self}}"
                          ToolTipDescription="Create a bathymetry file that will be loaded by MMMBS" IsEnabled="{Binding IsScenarioLoaded}"
                          Command="{Binding CreateMMMBSBathymetryFileCommand}" />
        </r:RibbonGroup>
      </r:RibbonTab>
      <r:RibbonTab KeyTip="V" Header="Environment">
        <r:RibbonGroup Header="Map">
          <r:RibbonButton Label="World Map" LargeImageSource="..\Images\LargeIcons\globe-icon.png"
                          SmallImageSource="..\Images\SmallIcons\globe-icon.png" Command="{Binding ZoomToWorldMapCommand}" />
        </r:RibbonGroup>
        <r:RibbonGroup Header="Range Complex">
          <ListView Width="150" Height="66" ItemsSource="{Binding RangeComplexes.RangeComplexList}"
                    SelectedItem="{Binding RangeComplexes.SelectedRangeComplex}" SelectedIndex="{Binding SelectedRangeComplexIndex}"
                    DisplayMemberPath="Name" ScrollViewer.HorizontalScrollBarVisibility="Disabled" SelectionMode="Single">
            <ListView.ItemsPanel>
              <ItemsPanelTemplate>
                <StackPanel />
              </ItemsPanelTemplate>
            </ListView.ItemsPanel>
          </ListView>
          <r:RibbonButton Label="New" LargeImageSource="..\Images\LargeIcons\world_add.png"
                          SmallImageSource="..\Images\SmallIcons\world_add.png"
                          ToolTipTitle="{Binding Label, RelativeSource={RelativeSource Self}}" ToolTipDescription="Define a new range complex"
                          Command="{Binding NewRangeComplexCommand}" IsEnabled="{Binding RangeComplexes.IsEnabled}" />
          <r:RibbonButton SmallImageSource="..\Images\SmallIcons\world_go.png"
                          ToolTipTitle="{Binding Label, RelativeSource={RelativeSource Self}}"
                          ToolTipDescription="Show the selected range complex on the map" Command="{Binding ZoomToRangeComplexCommand}" />
          <r:RibbonButton SmallImageSource="..\Images\SmallIcons\world_delete.png"
                          ToolTipTitle="{Binding Label, RelativeSource={RelativeSource Self}}"
                          ToolTipDescription="Delete the selected range complex, and all data within it"
                          Command="{Binding DeleteRangeComplexCommand}" />
          <r:RibbonButton SmallImageSource="..\Images\SmallIcons\arrow_undo.png"
                          ToolTipTitle="{Binding Label, RelativeSource={RelativeSource Self}}"
                          ToolTipDescription="Clear the currently selected range complex" Command="{Binding ClearRangeComplexSelectionCommand}" />
        </r:RibbonGroup>
        <r:RibbonGroup Header="Area">
          <ListView Width="200" Height="66"
                    ItemsSource="{Binding RangeComplexes.SelectedRangeComplex.AreaList}"
                    SelectedItem="{Binding RangeComplexes.SelectedArea}" SelectedIndex="{Binding SelectedAreaIndex}"
                    DisplayMemberPath="Name" ScrollViewer.HorizontalScrollBarVisibility="Disabled" ToolTip="Select a simulation area"
                    SelectionMode="Single">
            <ListView.ItemsPanel>
              <ItemsPanelTemplate>
                <StackPanel />
              </ItemsPanelTemplate>
            </ListView.ItemsPanel>
          </ListView>
          <r:RibbonButton Label="Expand" LargeImageSource="..\Images\LargeIcons\canvas_size.png"
                          SmallImageSource="..\Images\SmallIcons\canvas_size.png"
                          ToolTipTitle="{Binding Label, RelativeSource={RelativeSource Self}}"
                          ToolTipDescription="Create a new overlay by expanding the selected overlay"
                          ToolTipFooterDescription="Note: You cannot expand an overlay that was previously created by expanding another overlay"
                          Command="{Binding ExpandOverlayCommand}" />
          <r:RibbonButton SmallImageSource="..\Images\SmallIcons\overlay-new.png" ToolTipTitle="New Overlay"
                          ToolTipDescription="Create a new overlay" Command="{Binding NewOverlayCommand}" />
          <r:RibbonButton SmallImageSource="..\Images\SmallIcons\Button-Close-icon.png"
                          ToolTipTitle="{Binding Label, RelativeSource={RelativeSource Self}}"
                          ToolTipDescription="Delete the selected overlay, and all overlays, bathymetry and environment data that depends on it."
                          ToolTipFooterDescription="Note: Operational and simulation limit overlays for the currently selected range complex cannot be deleted."
                          IsEnabled="{Binding SelectedArea.CanBeDeleted}" Command="{Binding DeleteOverlayCommand}" />
          <r:RibbonButton SmallImageSource="..\Images\SmallIcons\arrow_undo.png"
                          ToolTipTitle="{Binding Label, RelativeSource={RelativeSource Self}}"
                          ToolTipDescription="Clear the currently selected area" Command="{Binding ClearAreaSelectionCommand}" />
        </r:RibbonGroup>
        <r:RibbonGroup Header="Bathymetry">
          <ListView Width="75" Height="66" ItemContainerStyle="{StaticResource DataCachedDisplayStyle}"
                    ItemsSource="{Binding RangeComplexes.SelectedArea.BathymetryList}"
                    SelectedItem="{Binding RangeComplexes.SelectedBathymetry}" SelectedIndex="{Binding SelectedBathymetryIndex}"
                    DisplayMemberPath="Name" ScrollViewer.HorizontalScrollBarVisibility="Disabled" ToolTip="Select a simulation area"
                    SelectionMode="Single" />
          <r:RibbonButton Label="Add" LargeImageSource="..\Images\LargeIcons\map_add.png"
                          SmallImageSource="..\Images\SmallIcons\map_add.png" ToolTipTitle="New Bathymetry"
                          ToolTipDescription="Extract a new bathymetry dataset" Command="{Binding AddBathymetryCommand}" />
          <r:RibbonButton SmallImageSource="..\Images\SmallIcons\map_delete.png"
                          ToolTipTitle="{Binding Label, RelativeSource={RelativeSource Self}}"
                          ToolTipDescription="Delete the selected bathymetry dataset" Command="{Binding RemoveBathymetryCommand}" />
          <r:RibbonButton SmallImageSource="..\Images\SmallIcons\arrow_refresh.png"
                          ToolTipTitle="{Binding Label, RelativeSource={RelativeSource Self}}"
                          ToolTipDescription="Re-import the selected bathymetry dataset" Command="{Binding ReloadBathymetryCommand}" />
          <r:RibbonButton SmallImageSource="..\Images\SmallIcons\arrow_undo.png"
                          ToolTipTitle="{Binding Label, RelativeSource={RelativeSource Self}}"
                          ToolTipDescription="Clear the currently selected bathymetry" Command="{Binding ClearBathymetrySelectionCommand}" />
        </r:RibbonGroup>
      </r:RibbonTab>
    </r:Ribbon>
    <Grid>
      <Grid.ColumnDefinitions>
        <ColumnDefinition
Width="{Binding LayersListWidth, Converter={StaticResource gridLengthConverter}, Mode=TwoWay}" />
        <ColumnDefinition Width="Auto" />
        <ColumnDefinition Width="*" MinWidth="500" />
      </Grid.ColumnDefinitions>
      <TabControl Visibility="{Binding IsLayerListViewVisible, Converter={StaticResource TrueVisibleFalseCollapsed}}">
        <TabItem Header="Map Layers">
          <LocalControls:LayerListView />
        </TabItem>
        <TabItem Header="Scenario View">
          <LocalControls:LayerTreeView />
        </TabItem>
        <TabItem Header="Environment">
          <DockPanel LastChildFill="True">
            <GroupBox Header="Import status" Margin="5" DockPanel.Dock="Bottom">
              <EnvironmentBuilder:ImportProgressListView ItemsSource="{Binding ImportProgressCollection}" />
            </GroupBox>
            <GroupBox Header="Selected data status" Margin="5" DockPanel.Dock="Bottom">
              <UniformGrid Rows="1">
                <StackPanel Orientation="Vertical"
                            DataContext="{Binding RangeComplexes.SelectedSediment.DataAvailability}">
                  <TextBlock Text="Sediment" TextAlignment="Center" />
                  <TextBlock Text="{Binding}" TextAlignment="Center" Style="{StaticResource DataAvailabilityStyle}" />
                </StackPanel>
                <StackPanel Orientation="Vertical"
                            DataContext="{Binding RangeComplexes.SelectedBathymetry.DataAvailability}">
                  <TextBlock Text="Bathymetry" TextAlignment="Center" />
                  <TextBlock Text="{Binding}" TextAlignment="Center" Style="{StaticResource DataAvailabilityStyle}" />
                </StackPanel>
                <StackPanel Orientation="Vertical"
                            DataContext="{Binding RangeComplexes.SelectedBottomLoss.DataAvailability}">
                  <TextBlock Text="Bottom Loss" TextAlignment="Center" />
                  <TextBlock Text="{Binding}" TextAlignment="Center" Style="{StaticResource DataAvailabilityStyle}" />
                </StackPanel>
                <StackPanel Orientation="Vertical"
                            DataContext="{Binding RangeComplexes.SelectedSoundSpeed.DataAvailability}">
                  <TextBlock Text="Sound Speed" TextAlignment="Center" />
                  <TextBlock Text="{Binding}" TextAlignment="Center" Style="{StaticResource DataAvailabilityStyle}" />
                </StackPanel>
                <StackPanel Orientation="Vertical" DataContext="{Binding RangeComplexes.SelectedWind.DataAvailability}">
                  <TextBlock Text="Wind" TextAlignment="Center" />
                  <TextBlock Text="{Binding}" TextAlignment="Center" Style="{StaticResource DataAvailabilityStyle}" />
                </StackPanel>
              </UniformGrid>
            </GroupBox>
            <GroupBox Header="Range Complexes" Margin="5" DockPanel.Dock="Top" HorizontalAlignment="Stretch"
                      VerticalAlignment="Stretch">
              <EnvironmentBuilder:RangeComplexTreeView DockPanel.Dock="Top" DataContext="{Binding RangeComplexes}"
                                                       IsEnabled="{Binding IsEnabled}"
                                                       ItemsSource="{Binding RangeComplexList, Converter={StaticResource SortConverter}, ConverterParameter='Name'}" />
            </GroupBox>
          </DockPanel>
        </TabItem>
      </TabControl>
      <GridSplitter Name="GridSplitter" Grid.Column="1"
                    Visibility="{Binding IsLayerListViewVisible, Converter={StaticResource TrueVisibleFalseCollapsed}}" Width="2"
                    Background="Black" HorizontalAlignment="Center" Margin="5,0,5,0" VerticalAlignment="Stretch"
                    ResizeBehavior="BasedOnAlignment" ResizeDirection="Columns" />
      <LocalControls:MapView Grid.Column="2" />
      <i:Interaction.Triggers>
        <i:EventTrigger EventName="Drop">
          <ia:CallMethodAction TargetObject="{Binding}" MethodName="FilesDropped" />
        </i:EventTrigger>
      </i:Interaction.Triggers>
    </Grid>
  </DockPanel>
</r:RibbonWindow>