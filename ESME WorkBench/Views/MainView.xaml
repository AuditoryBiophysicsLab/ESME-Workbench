<r:RibbonWindow x:Class="ESMEWorkbench.Views.MainView"
                xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
                xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
                xmlns:cinch="clr-namespace:Cinch;assembly=Cinch.WPF"
                xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
                xmlns:EnvironmentBuilder="clr-namespace:ESME.Views.EnvironmentBuilder;assembly=ESME.Views"
                xmlns:i="http://schemas.microsoft.com/expression/2010/interactivity"
                xmlns:ia="http://schemas.microsoft.com/expression/2010/interactions"
                xmlns:LocalControls="clr-namespace:ESMEWorkbench.Controls"
                xmlns:Main="clr-namespace:ESMEWorkbench.ViewModels.Main"
                xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
                xmlns:mef="http:\\www.codeplex.com\MEFedMVVM"
                xmlns:NAVO="clr-namespace:ESME.Environment.NAVO;assembly=ESME"
                xmlns:p="clr-namespace:ESMEWorkbench.Properties"
                xmlns:r="clr-namespace:Microsoft.Windows.Controls.Ribbon;assembly=RibbonControlsLibrary"
                xmlns:Utility="clr-namespace:HRC.Utility;assembly=HRC"
                xmlns:WPF="clr-namespace:HRC.WPF;assembly=HRC"
                Title="{Binding MainWindowTitle}"
                Width="{Binding Source={x:Static p:Settings.Default},
                                Path=WindowWidth,
                                Mode=TwoWay}"
                Height="{Binding Source={x:Static p:Settings.Default},
                                 Path=WindowHeight,
                                 Mode=TwoWay}"
                d:DataContext="{d:DesignInstance Type=Main:MainViewModel}"
                d:DesignHeight="500"
                d:DesignWidth="900"
                Icon="..\Wave.ico"
                Left="{Binding Source={x:Static p:Settings.Default},
                               Path=WindowLeft,
                               Mode=TwoWay}"
                mef:ViewModelLocator.ViewModel="MainViewModel"
                SnapsToDevicePixels="True"
                Top="{Binding Source={x:Static p:Settings.Default},
                              Path=WindowTop,
                              Mode=TwoWay}"
                mc:Ignorable="d">
    <r:RibbonWindow.Resources>
        <WPF:GridLengthConverter x:Key="GridLengthConverter" />
        <Utility:NotNullConverter x:Key="NotNull" />
        <Utility:BooleanNegatingConverter x:Key="NegatingConverter" />
    </r:RibbonWindow.Resources>
    <r:RibbonWindow.InputBindings>
        <KeyBinding Key="Escape" Command="{Binding CancelCurrentCommand}" />
        <KeyBinding Key="O"
                    Command="{Binding OpenScenarioCommand}"
                    Modifiers="Control" />
    </r:RibbonWindow.InputBindings>
    <i:Interaction.Triggers>
        <i:EventTrigger EventName="Closing">
            <cinch:EventToCommandTrigger Command="{Binding ViewClosingCommand}" />
        </i:EventTrigger>
        <i:EventTrigger EventName="Activated">
            <cinch:EventToCommandTrigger Command="{Binding ViewActivatedCommand}" />
        </i:EventTrigger>
        <i:EventTrigger EventName="PreviewKeyDown">
            <cinch:EventToCommandTrigger Command="{Binding PreviewKeyDownCommand}" />
        </i:EventTrigger>
    </i:Interaction.Triggers>
    <DockPanel LastChildFill="True">
        <StatusBar DockPanel.Dock="Bottom">
            <StatusBarItem HorizontalAlignment="Left">
                <TextBlock Text="{Binding MouseLocationInfo}" />
            </StatusBarItem>
        </StatusBar>
        <!--  SelectedIndex="{Binding Source={x:Static p:Settings.Default}, Path=SelectedRibbonTabIndex, Mode=TwoWay}"  -->
        <r:Ribbon x:Name="Ribbon"
                  DockPanel.Dock="Top"
                  SelectedIndex="{Binding SelectedRibbonTabIndex}">
            <r:Ribbon.ApplicationMenu>
                <r:RibbonApplicationMenu SmallImageSource="..\Images\SmallIcons\Wave.png">
                    <r:RibbonApplicationMenuItem Command="{Binding OpenScenarioCommand}"
                                                 Header="Open Scenario"
                                                 ImageSource="..\Images\LargeIcons\open-icon.png"
                                                 InputGestureText="Ctrl+O"
                                                 ToolTipDescription="Open a scenario file"
                                                 ToolTipTitle="{Binding Header,
                                                                        RelativeSource={RelativeSource Self}}" />
                    <r:RibbonApplicationMenuItem Command="{Binding NewScenarioCommand}"
                                                 Header="New Scenario"
                                                 ImageSource="..\Images\LargeIcons\new-icon.png"
                                                 InputGestureText="Ctrl+N"
                                                 ToolTipDescription="Create a new scenario"
                                                 ToolTipTitle="{Binding Header,
                                                                        RelativeSource={RelativeSource Self}}" />
                    <r:RibbonApplicationMenuItem Command="{Binding CloseScenarioCommand}"
                                                 Header="Close Scenario"
                                                 ImageSource="..\Images\LargeIcons\close-icon.png"
                                                 ToolTipDescription="Close the current scenario file"
                                                 ToolTipTitle="{Binding Header,
                                                                        RelativeSource={RelativeSource Self}}" />
                    <r:RibbonApplicationMenuItem Command="{Binding AboutCommand}"
                                                 Header="About"
                                                 ImageSource="..\Images\LargeIcons\about-icon.png"
                                                 ToolTipDescription="Information about the ESME Workbench"
                                                 ToolTipTitle="{Binding Header,
                                                                        RelativeSource={RelativeSource Self}}" />
                    <r:RibbonSeparator />
                    <r:RibbonApplicationMenuItem Command="{Binding EditOptionsCommand}"
                                                 Header="Options"
                                                 ImageSource="..\Images\LargeIcons\gear-icon.png"
                                                 ToolTipDescription="Edit application options and settings"
                                                 ToolTipTitle="{Binding Header,
                                                                        RelativeSource={RelativeSource Self}}" />
                    <r:RibbonApplicationMenuItem Command="{Binding HelpCommand}"
                                                 Header="Help"
                                                 ImageSource="..\Images\LargeIcons\Button-Help-icon.png"
                                                 ToolTipDescription="Opens the user manual for the ESME Workbench"
                                                 ToolTipTitle="{Binding Header,
                                                                        RelativeSource={RelativeSource Self}}" />
                    <r:RibbonSeparator />
                    <r:RibbonApplicationMenuItem Command="Close"
                                                 Header="Exit"
                                                 ImageSource="..\Images\LargeIcons\Button-Close-icon.png"
                                                 ToolTipDescription="Close ESME Workbench"
                                                 ToolTipTitle="{Binding Header,
                                                                        RelativeSource={RelativeSource Self}}" />

                    <r:RibbonApplicationMenu.AuxiliaryPaneContent>
                        <Grid>
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto" />
                                <RowDefinition Height="5" />
                                <RowDefinition Height="*" />
                            </Grid.RowDefinitions>
                            <r:RibbonSeparator Grid.Row="0" Label="Recent Scenarios" />
                            <r:RibbonGallery Grid.Row="2"
                                             CanUserFilter="False"
                                             ScrollViewer.VerticalScrollBarVisibility="Auto"
                                             SelectedItem="{Binding RecentFilesSelectedItem}">
                                <r:RibbonGalleryCategory Background="Transparent" ItemsSource="{Binding RecentFiles.List}">
                                    <r:RibbonGalleryCategory.ItemsPanel>
                                        <ItemsPanelTemplate>
                                            <StackPanel IsItemsHost="True" Orientation="Vertical" />
                                        </ItemsPanelTemplate>
                                    </r:RibbonGalleryCategory.ItemsPanel>
                                    <r:RibbonGalleryCategory.ItemTemplate>
                                        <DataTemplate>
                                            <TextBlock Text="{Binding ShortName}" />
                                        </DataTemplate>
                                    </r:RibbonGalleryCategory.ItemTemplate>
                                    <r:RibbonGalleryCategory.Style>
                                        <Style />
                                    </r:RibbonGalleryCategory.Style>
                                </r:RibbonGalleryCategory>
                            </r:RibbonGallery>
                        </Grid>
                    </r:RibbonApplicationMenu.AuxiliaryPaneContent>
                </r:RibbonApplicationMenu>
            </r:Ribbon.ApplicationMenu>
            <r:RibbonTab Header="Home" KeyTip="H">
                <r:RibbonGroup Header="Overlays">
                    <r:RibbonCheckBox IsChecked="{Binding IsLatLonGridVisible}"
                                      Label="Lat/Lon Grid"
                                      ToolTipDescription="Shows and hides the latitude/longitude grid overlay on the map"
                                      ToolTipTitle="{Binding Label,
                                                             RelativeSource={RelativeSource Self}}" />
                    <r:RibbonCheckBox IsChecked="{Binding IsPanZoomVisible}"
                                      Label="Pan &amp; Zoom"
                                      ToolTipDescription="Shows and hides the pan/zoom control overlay on the map"
                                      ToolTipTitle="{Binding Label,
                                                             RelativeSource={RelativeSource Self}}" />
                    <r:RibbonCheckBox IsChecked="{Binding IsScaleBarVisible}"
                                      Label="Scale Bar"
                                      ToolTipDescription="Shows and hides the scale bar overlay on the map"
                                      ToolTipTitle="{Binding Label,
                                                             RelativeSource={RelativeSource Self}}" />
                </r:RibbonGroup>
                <r:RibbonGroup Header="Scenario">
                    <ListView Width="150"
                              Height="66"
                              DisplayMemberPath="Name"
                              ItemsSource="{Binding Database.Scenarios}"
                              ScrollViewer.HorizontalScrollBarVisibility="Disabled"
                              SelectedItem="{Binding Scenario}"
                              SelectionMode="Single">
                        <ListView.ItemsPanel>
                            <ItemsPanelTemplate>
                                <StackPanel />
                            </ItemsPanelTemplate>
                        </ListView.ItemsPanel>
                    </ListView>
                    <r:RibbonButton Command="{Binding ImportScenarioFileCommand}"
                                    Label="Import"
                                    SmallImageSource="..\Images\SmallIcons\layer_import.png"
                                    ToolTipDescription="Create a new scenario by loading a NEMO scenario file"
                                    ToolTipTitle="Create a location from an existing NEMO scenario and Sim Area files" />
                    <r:RibbonButton Command="{Binding DisabledCommand}"
                                    Label="Create"
                                    SmallImageSource="..\Images\SmallIcons\layer_to_image_size.png"
                                    ToolTipDescription="This feature is not yet implemented"
                                    ToolTipTitle="Create a location by selecting an area on the map" />
                    <r:RibbonButton Command="{Binding DisabledCommand}"
                                    Label="Edit"
                                    SmallImageSource="..\Images\SmallIcons\layer_edit.png"
                                    ToolTipDescription="Not yet implemented"
                                    ToolTipTitle="Edit scenario" />
                    <r:RibbonButton Command="{Binding DisabledCommand}"
                                    Label="Delete"
                                    SmallImageSource="..\Images\SmallIcons\layer_delete.png"
                                    ToolTipDescription="Delete the selected scenario"
                                    ToolTipTitle="Delete scenario" />
                    <r:RibbonButton Command="{Binding DisabledCommand}"
                                    IsEnabled="{Binding IsScenarioLoaded}"
                                    Label="Zoom"
                                    SmallImageSource="..\Images\SmallIcons\Magnifying-Glass-icon.png"
                                    ToolTipDescription="Resets the map position to the current scenario"
                                    ToolTipTitle="{Binding Label,
                                                           RelativeSource={RelativeSource Self}}" />
                </r:RibbonGroup>
                <r:RibbonGroup Header="Acoustics">
                    <r:RibbonButton Command="{Binding ExportAnalysisPointsCommand}"
                                    Label="Export"
                                    LargeImageSource="..\Images\LargeIcons\hourglass_go.png"
                                    SmallImageSource="..\Images\SmallIcons\export-icon.png"
                                    ToolTipDescription="Export all Analysis Points to be calculated by the various acoustic models (configure the models using the Models button)"
                                    ToolTipTitle="{Binding Label,
                                                           RelativeSource={RelativeSource Self}}" />
                    <r:RibbonToggleButton IsChecked="{Binding IsInAnalysisPointMode}"
                                          IsEnabled="{Binding CanPlaceAnalysisPoint}"
                                          Label="Analysis Point"
                                          SmallImageSource="..\Images\SmallIcons\location_pin.png"
                                          ToolTipDescription="Add a new analysis point to the experiment"
                                          ToolTipTitle="{Binding Label,
                                                                 RelativeSource={RelativeSource Self}}" />
                    <r:RibbonButton Command="{Binding ConfigureAcousticModelsCommand}"
                                    IsEnabled="{Binding IsScenarioLoaded}"
                                    Label="Models"
                                    SmallImageSource="..\Images\SmallIcons\chart_curve_edit.png"
                                    ToolTipDescription="Choose an acoustic model for each distinct mode in the scenario"
                                    ToolTipTitle="{Binding Label,
                                                           RelativeSource={RelativeSource Self}}" />
                    <r:RibbonButton Command="{Binding ReverifyAcousticModelsCommand}"
                                    IsEnabled="{Binding IsScenarioLoaded}"
                                    Label="Re-verify"
                                    SmallImageSource="..\Images\SmallIcons\update.png"
                                    ToolTipDescription="Force reverification of acoustic fields in this scenario"
                                    ToolTipTitle="{Binding Label,
                                                           RelativeSource={RelativeSource Self}}" />
                </r:RibbonGroup>
            </r:RibbonTab>
            <r:RibbonTab Header="Environment" KeyTip="V">
                <r:RibbonGroup Header="Map">
                    <r:RibbonButton Command="{Binding ZoomToWorldMapCommand}"
                                    Label="World Map"
                                    LargeImageSource="..\Images\LargeIcons\globe-icon.png"
                                    SmallImageSource="..\Images\SmallIcons\globe-icon.png" />
                </r:RibbonGroup>
                <r:RibbonGroup Header="Location">
                    <ListView Width="150"
                              Height="66"
                              DisplayMemberPath="Name"
                              ItemsSource="{Binding Database.Locations}"
                              ScrollViewer.HorizontalScrollBarVisibility="Disabled"
                              SelectedIndex="{Binding SelectedLocationIndex}"
                              SelectedItem="{Binding SelectedLocation}"
                              SelectionMode="Single">
                        <ListView.ItemsPanel>
                            <ItemsPanelTemplate>
                                <StackPanel />
                            </ItemsPanelTemplate>
                        </ListView.ItemsPanel>
                    </ListView>
                    <r:RibbonMenuButton Label="Add"
                                        SmallImageSource="..\Images\SmallIcons\layer_add.png"
                                        ToolTipDescription="Add a new location through one of several available means"
                                        ToolTipTitle="Add location">
                        <r:RibbonMenuItem Command="{Binding CreateLocationFromBoundingBoxCommand}"
                                          Header="Enter boundaries..."
                                          ImageSource="..\Images\SmallIcons\layer_command.png"
                                          ToolTipDescription="Create a new location by entering its northern, southern, eastern and western boundaries"
                                          ToolTipTitle="Create a new location by specifying its boundaries" />
                        <r:RibbonMenuItem Command="{Binding CreateLocationFromOverlayFileCommand}"
                                          Header="Import overlay file..."
                                          ImageSource="..\Images\SmallIcons\layer_import.png"
                                          ToolTipDescription="Create a new location by loading an overlay file that specifies its northern, southern, eastern and western boundaries"
                                          ToolTipTitle="Create a location from an existing overlay file" />
                        <r:RibbonMenuItem Command="{Binding DisabledCommand}"
                                          Header="Import location file..."
                                          ImageSource="..\Images\SmallIcons\layer_database.png"
                                          ToolTipDescription="This feature is not yet implemented"
                                          ToolTipTitle="Create a location by importing a location file" />
                        <r:RibbonMenuItem Command="{Binding DisabledCommand}"
                                          Header="Selecting area on map"
                                          ImageSource="..\Images\SmallIcons\layer_to_image_size.png"
                                          ToolTipDescription="This feature is not yet implemented"
                                          ToolTipTitle="Create a location by selecting an area on the map" />
                    </r:RibbonMenuButton>
                    <r:RibbonButton Command="{Binding DisabledCommand}"
                                    Label="Edit"
                                    SmallImageSource="..\Images\SmallIcons\layer_edit.png"
                                    ToolTipDescription="Edit the boundaries and/or cached environmental data of the selected location"
                                    ToolTipTitle="Edit location" />
                    <r:RibbonButton Command="{Binding DisabledCommand}"
                                    Label="Delete"
                                    SmallImageSource="..\Images\SmallIcons\layer_delete.png"
                                    ToolTipDescription="Delete an existing location, along with all cached data and all scenarios that depend upon it"
                                    ToolTipTitle="Delete location" />
                </r:RibbonGroup>
                <r:RibbonGroup Header="Range Complex" ToolTip="{Binding ScenarioLoadedToolTip}">
                    <ListView Width="150"
                              Height="66"
                              DisplayMemberPath="Name"
                              IsEnabled="{Binding IsScenarioLoaded,
                                                  Converter={StaticResource NegatingConverter}}"
                              ItemsSource="{Binding RangeComplexes.RangeComplexList}"
                              ScrollViewer.HorizontalScrollBarVisibility="Disabled"
                              SelectedIndex="{Binding RangeComplexes.SelectedRangeComplexIndex}"
                              SelectedItem="{Binding RangeComplexes.SelectedRangeComplex}"
                              SelectionMode="Single">
                        <ListView.ItemsPanel>
                            <ItemsPanelTemplate>
                                <StackPanel />
                            </ItemsPanelTemplate>
                        </ListView.ItemsPanel>
                    </ListView>
                    <r:RibbonButton Command="{Binding NewRangeComplexCommand}"
                                    IsEnabled="{Binding IsScenarioLoaded,
                                                        Converter={StaticResource NegatingConverter}}"
                                    Label="New"
                                    LargeImageSource="..\Images\LargeIcons\world_add.png"
                                    SmallImageSource="..\Images\SmallIcons\world_add.png"
                                    ToolTipDescription="Define a new range complex"
                                    ToolTipTitle="New range complex" />
                    <r:RibbonButton Command="{Binding ZoomToRangeComplexCommand}"
                                    IsEnabled="{Binding IsScenarioLoaded,
                                                        Converter={StaticResource NegatingConverter}}"
                                    SmallImageSource="..\Images\SmallIcons\world_go.png"
                                    ToolTipDescription="Show the selected range complex on the map"
                                    ToolTipTitle="Show range complex" />
                    <r:RibbonButton Command="{Binding DeleteRangeComplexCommand}"
                                    IsEnabled="{Binding IsScenarioLoaded,
                                                        Converter={StaticResource NegatingConverter}}"
                                    SmallImageSource="..\Images\SmallIcons\world_delete.png"
                                    ToolTipDescription="Delete the selected range complex, and all data within it"
                                    ToolTipTitle="Delete range complex" />
                    <r:RibbonButton Command="{Binding ClearRangeComplexSelectionCommand}"
                                    IsEnabled="{Binding IsScenarioLoaded,
                                                        Converter={StaticResource NegatingConverter}}"
                                    SmallImageSource="..\Images\SmallIcons\arrow_undo.png"
                                    ToolTipDescription="Clear the currently selected range complex"
                                    ToolTipTitle="Clear selection" />
                    <r:RibbonButton Command="{Binding ReimportRangeComplexCommand}"
                                    IsEnabled="{Binding IsScenarioLoaded,
                                                        Converter={StaticResource NegatingConverter}}"
                                    SmallImageSource="..\Images\SmallIcons\arrow_refresh.png"
                                    ToolTipDescription="Re-import all environment data for the current range complex"
                                    ToolTipTitle="Re-import range complex" />
                </r:RibbonGroup>
                <r:RibbonGroup Header="Time Period" ToolTip="{Binding ScenarioLoadedToolTip}">
                    <ListView Width="80"
                              Height="66"
                              IsEnabled="{Binding IsScenarioLoaded,
                                                  Converter={StaticResource NegatingConverter}}"
                              ItemsSource="{x:Static NAVO:NAVOConfiguration.AllTimePeriods}"
                              ScrollViewer.HorizontalScrollBarVisibility="Disabled"
                              SelectedIndex="{Binding RangeComplexes.SelectedTimePeriodIndex}"
                              SelectedItem="{Binding RangeComplexes.SelectedTimePeriod}"
                              SelectionMode="Single">
                        <ListView.ItemsPanel>
                            <ItemsPanelTemplate>
                                <StackPanel />
                            </ItemsPanelTemplate>
                        </ListView.ItemsPanel>
                    </ListView>
                </r:RibbonGroup>
                <r:RibbonGroup Header="Area">
                    <ListView Width="200"
                              Height="66"
                              DisplayMemberPath="Name"
                              IsEnabled="{Binding RangeComplexes.SelectedRangeComplex,
                                                  Converter={StaticResource NotNull}}"
                              ItemsSource="{Binding RangeComplexes.SelectedRangeComplex.AreaList}"
                              ScrollViewer.HorizontalScrollBarVisibility="Disabled"
                              SelectedIndex="{Binding RangeComplexes.SelectedAreaIndex}"
                              SelectedItem="{Binding RangeComplexes.SelectedArea}"
                              SelectionMode="Single"
                              ToolTip="Select a simulation area">
                        <ListView.ItemsPanel>
                            <ItemsPanelTemplate>
                                <StackPanel />
                            </ItemsPanelTemplate>
                        </ListView.ItemsPanel>
                    </ListView>
                    <r:RibbonButton Command="{Binding ExpandOverlayCommand}"
                                    Label="Expand"
                                    LargeImageSource="..\Images\LargeIcons\canvas_size.png"
                                    SmallImageSource="..\Images\SmallIcons\canvas_size.png"
                                    ToolTipDescription="Create a new overlay by expanding the selected overlay"
                                    ToolTipFooterDescription="Note: You cannot expand an overlay that was previously created by expanding another overlay"
                                    ToolTipTitle="Expand area" />
                    <r:RibbonButton Command="{Binding NewOverlayCommand}"
                                    SmallImageSource="..\Images\SmallIcons\overlay-new.png"
                                    ToolTipDescription="Create a new area in the current range complex"
                                    ToolTipTitle="New Area" />
                    <r:RibbonButton Command="{Binding DeleteOverlayCommand}"
                                    IsEnabled="{Binding RangeComplexes.SelectedArea.CanBeDeleted}"
                                    SmallImageSource="..\Images\SmallIcons\Button-Close-icon.png"
                                    ToolTipDescription="Delete the selected area from the current range complex"
                                    ToolTipFooterDescription="Note: Operational and simulation limit overlays for the currently selected range complex cannot be deleted."
                                    ToolTipTitle="Delete area" />
                    <r:RibbonButton Command="{Binding ClearAreaSelectionCommand}"
                                    SmallImageSource="..\Images\SmallIcons\arrow_undo.png"
                                    ToolTipDescription="Clear the currently selected area"
                                    ToolTipTitle="Clear the currently selected area" />
                </r:RibbonGroup>
                <r:RibbonGroup Header="Bathymetry">
                    <ListView Width="75"
                              Height="66"
                              DisplayMemberPath="Name"
                              IsEnabled="{Binding RangeComplexes.SelectedRangeComplex,
                                                  Converter={StaticResource NotNull}}"
                              ItemContainerStyle="{StaticResource DataCachedDisplayStyle}"
                              ItemsSource="{Binding RangeComplexes.SelectedArea.BathymetryList}"
                              ScrollViewer.HorizontalScrollBarVisibility="Disabled"
                              SelectedIndex="{Binding RangeComplexes.SelectedBathymetryIndex}"
                              SelectedItem="{Binding RangeComplexes.SelectedBathymetry}"
                              SelectionMode="Single"
                              ToolTip="Select a simulation area" />
                    <r:RibbonButton Command="{Binding AddBathymetryCommand}"
                                    Label="Add"
                                    LargeImageSource="..\Images\LargeIcons\map_add.png"
                                    SmallImageSource="..\Images\SmallIcons\map_add.png"
                                    ToolTipDescription="Extract a new bathymetry dataset"
                                    ToolTipTitle="New Bathymetry" />
                    <r:RibbonButton Command="{Binding RemoveBathymetryCommand}"
                                    SmallImageSource="..\Images\SmallIcons\map_delete.png"
                                    ToolTipDescription="Delete the selected bathymetry dataset"
                                    ToolTipTitle="Delete bathymetry" />
                    <r:RibbonButton Command="{Binding ReloadBathymetryCommand}"
                                    SmallImageSource="..\Images\SmallIcons\arrow_refresh.png"
                                    ToolTipDescription="Re-import the selected bathymetry dataset"
                                    ToolTipTitle="Re-import bathymetry" />
                    <r:RibbonButton Command="{Binding ClearBathymetrySelectionCommand}"
                                    SmallImageSource="..\Images\SmallIcons\arrow_undo.png"
                                    ToolTipDescription="Clear the currently selected bathymetry"
                                    ToolTipTitle="Clear selection" />
                </r:RibbonGroup>
                <r:RibbonGroup Header="Export">
                    <r:RibbonButton Command="{Binding ExportAllEnvironmentalDataCommand}"
                                    Label="Export"
                                    LargeImageSource="..\Images\LargeIcons\export-icon.png"
                                    ToolTipDescription="Write the currently selected environmental data to disk."
                                    ToolTipTitle="Export" />
                </r:RibbonGroup>
            </r:RibbonTab>

            <r:RibbonTab Header="Simulation" KeyTip="S">
                <r:RibbonGroup Header="Simulators">
                    <r:RibbonButton Command="{Binding RunTransmissionLossCalculatorCommand}"
                                    Label="Acoustic Simulator"
                                    LargeImageSource="..\Images\LargeIcons\orbz_water.png"
                                    SmallImageSource="..\Images\SmallIcons\orbz_water.png"
                                    ToolTipDescription="Runs the Acoustic Simulator. The icon will appear in your system tray."
                                    ToolTipTitle="{Binding Label,
                                                           RelativeSource={RelativeSource Self}}" />

                </r:RibbonGroup>

                <r:RibbonGroup Header="Animals">
                    <r:RibbonButton Command="{Binding LaunchMMMBSCommand}"
                                    Label="MMMBS"
                                    LargeImageSource="..\Images\3mbNewIcon.ico"
                                    SmallImageSource="..\Images\3mbNewIcon.ico"
                                    ToolTipDescription="Launch the Marine Mammal Movement and Behavior Simulator to define animat populations."
                                    ToolTipTitle="{Binding Label,
                                                           RelativeSource={RelativeSource Self}}" />
                    <r:RibbonButton Command="{Binding CreateMMMBSBathymetryFileCommand}"
                                    Label="Export Bathymetry File"
                                    SmallImageSource="..\Images\SmallIcons\export-icon.png"
                                    ToolTipDescription="Create a bathymetry file that will be loaded by MMMBS"
                                    ToolTipTitle="{Binding Label,
                                                           RelativeSource={RelativeSource Self}}" />
                </r:RibbonGroup>
            </r:RibbonTab>
        </r:Ribbon>
        <Grid>
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="{Binding Source={x:Static p:Settings.Default}, Path=LayersWidth, Mode=TwoWay, Converter={StaticResource GridLengthConverter}}" />
                <ColumnDefinition Width="Auto" />
                <ColumnDefinition Width="*" MinWidth="500" />
            </Grid.ColumnDefinitions>
            <LocalControls:LayerTreeView Grid.Column="0" DataContext="{Binding LayerTreeViewModel}"/>
            <GridSplitter Grid.Column="1"
                          Width="2"
                          Margin="5,0,5,0"
                          HorizontalAlignment="Center"
                          VerticalAlignment="Stretch"
                          Background="Black"
                          ResizeBehavior="BasedOnAlignment"
                          ResizeDirection="Columns" />
            <LocalControls:MapView Grid.Column="2" />
            <i:Interaction.Triggers>
                <i:EventTrigger EventName="Drop">
                    <ia:CallMethodAction MethodName="FilesDropped" TargetObject="{Binding}" />
                </i:EventTrigger>
            </i:Interaction.Triggers>
        </Grid>
    </DockPanel>
</r:RibbonWindow>